<html>
<body>
  <h1>Test Chat Heylight</h1>
  <!-- Custom Chat Launcher -->
  <button id="custom-chat-launcher" class="custom-launcher-tab" onclick="launchChat()">Serve aiuto?</button>
  <style>
    .custom-launcher-tab {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #EA1C00;
      color: white;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      font-size: 14px;
      font-family: "HeyLight Sans", Arial;
      z-index: 9998;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border: none;
    }
    .custom-launcher-tab:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    .custom-launcher-tab.loading {
      opacity: 0.8;
    }
  </style>
  <script type='text/javascript'>
    function initEmbeddedMessaging() {
      try {
        embeddedservice_bootstrap.settings.language = 'it';
        embeddedservice_bootstrap.settings.hideChatButtonOnLoad = true;
        window.addEventListener('onEmbeddedMessagingReady', () => {
          console.log('Embedded Messaging Ready');
          window.embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
            "ActionName": "Supporto Heylight",
            "Origin": "Portale HeyLight",
            "Categoria": "Categoria Portale HeyLight 3",
            "RawActionName": "Supporto",
            "ProductName": "Prodotto di test",
            "MerchantName": "Heylight",
            "MerchantID": "5498730",
            "SessionID": "453455498730",
            "OpsApplicationUrl": "https://www.google.com/",
            "OriginationChannel": "Test Origination Channel"
          });
        });
        embeddedservice_bootstrap.init(
          '00D9X00000FicnO',
          'test2_fg',
          'https://compasscrm--uat3.sandbox.my.site.com/ESWtest2fg1765897989768',
          {
            scrt2URL: 'https://compasscrm--uat3.sandbox.my.salesforce-scrt.com'
          }
        );
      } catch (err) {
        console.error('Error loading Embedded Messaging: ', err);
      }
    };
    // Launch Chat API
    function launchChat() {
      embeddedservice_bootstrap.utilAPI.launchChat()
        .then(() => {
          console.log('Chat launched successfully');
          updateLauncherText('Un attimo e arriviamo!');
        })
        .catch(() => {
          console.error('Error launching chat');
        })
        .finally(() => {
          console.log('Chat launch attempt completed');
        });
    }
    // Funzione per aggiornare il testo del launcher
    function updateLauncherText(text) {
      const launcher = document.getElementById('custom-chat-launcher');
      if (launcher) {
        launcher.textContent = text;
        launcher.classList.add('loading');
      }
    }
  </script>
  <script type='text/javascript' src='https://compasscrm--uat3.sandbox.my.site.com/ESWtest2fg1765897989768/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>
</body>
</html>

